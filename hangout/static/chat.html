<html>
<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script src="/xsocket.io.min.js"></script>
  <script>
    var socket = io.connect('http://localhost:8080');
    socket.on('my_name_is', function(data) {
      $('#name').text(data.user);
    });
    socket.on('chat', function(data) {
      console.log(data);
      addLine(data.user, data.message);
    });
    socket.on('new_user', function(data) {
      console.log(data);
      addSpecialLine(data.user, 'has entered');
    });
    socket.on('lost_user', function(data) {
      console.log(data);
      addSpecialLine(data.user, 'has left');
    });

    function addLine(name, message) {
      $('<div/>').html(name + ': ' + message)
        .appendTo($('#console'));
    }
    function addSpecialLine(name, message) {
      $('<div/>').html('<i>' + name + ' ' + message + '</i>')
        .appendTo($('#console'));
    }

    $(function() {
      $('#line').keypress(function(e) {
        if (e.charCode != 13) return;

        socket.emit('chat', { message: this.value });
        $('#line').prop('value', '');
      });
    });
  </script>
</head>

<body>
  <p>You are: <b id=name>&hellip;</b></p>
  <input type=text id=line size=40 />
  <div id=console></div>
</body>
</html>
